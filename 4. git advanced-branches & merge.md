# Git Branch & Merge

## Understanding merge types

There are mainly two types of merge in git:
- Fast forward merge
- non fast forward
    - recursive 
    - Octopus
    - ours
    - Subtree

Out of the above, most common type of merges are fast forward and recursive non fast forward

>>## Fast forward merge
the fast forward merge is the most common one. git uses fast forward when there is additional commit in the master branch after the feature branch was created. 

The head is moved from the feature to the master branch. It is continuous single flow of commits.

```git
>git log
commit 45029b8678406ce1e3194a25b1893a8a5b70924d (HEAD -> master, feature)
    f2
commit 6ab73a983ab7a0b5592280b5b620db0775425098
    f1
commit 4bd5bd6d382f8242a7c053799ff5a58ab7100e07
    m2
commit 60a2ddcb54140cfb801abe3d865e20550b28d53a
    m1
```

- So here when the merge is done and given that there is no further commits in the master branch after feature branch was created, 
- then the merge is fast forward type meaning when the merge is done the head from the master to the latest commit in the feature branch (f2)
- Important thing to note here is that when feature branch are commited, then the feature branch also contains the additional two commits of the master branch
- **with fast forward merege, we dont create a new commit, we just move the pointer/header from the master to the lastest commit of the feature branch** 

**Merge changes into a new commit**
- If we want to have a single commit in the master branch for the latest commit from the feature branch, then we can use `--squash` flag
- In the master branch, if we go and rest to 2 commits before then the head/pointer moves to m2 commit of the master

When Head is in the master branch:
```
git merge --squash "feature_branch"
```
Here the a new commit is created which consists of the latest commit of the feature branch. And now the master branch will have one single new commit in its log, which is the latest feature branch commit.

## Recursive type merge

Recursive unlike fast forward happens when there is single or multiple commits in master branch after creatiion of the feature branch. 

The base for the two branches is no longer the same

To perform a recursive type merge:

```git 
git merge --no-ff "branch name"
```
Now the master branch log will consist of all the commits of the feature branch individually and also a new branch named "Merge branch 'feature', which is automatically created by git

if we make any changes in the master branch after branching the feature branch and then we merge the branches to master, by default the recursive merge is used by git. 

In this situation:
```git
>git log
commit 45029b8678406ce1e3194a25b1893a8a5b70924d (HEAD -> master, feature)
    merge branch 'feature'
commit 45029b8678406ce1e3194a25b1893a8a5b70924d (HEAD -> master, feature)
    'm3'
commit 45029b8678406ce1e3194a25b1893a8a5b70924d (HEAD -> master, feature)
    f2
commit 6ab73a983ab7a0b5592280b5b620db0775425098
    f1
commit 4bd5bd6d382f8242a7c053799ff5a58ab7100e07
    m2
commit 60a2ddcb54140cfb801abe3d865e20550b28d53a
    m1
```
Notes:
1. This contains the merged branch commit followed by all the feature and master branches
2. Interesting to note that m3 commit is above f2 feature commit
3. Also we can `squash` the commits of the feature branch while merging:
```
git merge --squash feature
```
Note that after using merge with `squash` flag will staged the changes caused by the merging so we will have to commit the merge to complete the merge:
```
git add . 
git commit -m "master and feature merged"
```
git log:
```
>git log
commit 45029b8678406ce1e3194a25b1893a8a5b70924d (HEAD -> master, feature)
    master and feature merged
commit 45029b8678406ce1e3194a25b1893a8a5b70924d (HEAD -> master, feature)
    'm3'
commit 4bd5bd6d382f8242a7c053799ff5a58ab7100e07
    m2
commit 60a2ddcb54140cfb801abe3d865e20550b28d53a
    m1
```
note here master branch log doesnot contain the commits of the feature branch because we used `squash` flag.
